# 秀丸エディタ上でrubyなどのコマンドを実行するマクロ

### 概要

秀丸エディタのマクロは、マクロから外部コマンドが起動できて、秀丸エディタ上で選択している文字列を入出力する事ができます。

これを利用して、ソフトウェア開発で便利そうなruby処理を呼べるようにした秀丸マクロです。

秀丸エディタ上で入力したコマンド文字列を、選択して実行します。その実行結果は秀丸エディタに貼られます。

以下の機能があります。  
* URLエスケープ/アンエスケープ
* HTMLエスケープ/アンスエケープ
* ダブルクォートエスケープ
* HTML整形
* JSON整形
* XML整形
* Base64デコード
* UTC日付を読める形式に変換
* Ruby式の実行
* コマンド実行


### 使い方

秀丸エディタ上で、対象となる文字列を選択し、マクロ実行によって表示されるメニューから行いたい機能を選びます。  

たとえば、以下のような文字を選択し、JSON整形を行うと、この文字の代わりに整形されたJSONが秀丸エディタ上に置換されます。  

```
{"a":{"b":1}}
```

### 作成した背景

REST APIのサービスを開発していて、curlコマンドを頻繁に利用するのですが、少しパラメタを変更するようなケースでは、ターミナル上で修正せず、テキストエディタで修正して、それをターミナルにコピペで、していました。  
これが面倒になったので、、Emacsのようにエディタ上で修正できてコマンドも実行できるといいなー、できれば使い慣れている秀丸エディタで。
という目的で作りました。  

### インストール方法

1. Rubyのインストール
1. 秀丸エディタの「マクロファイル用のフォルダ」を確認
    - 「その他(O)」→「動作環境(E)...」
    - ダイアログ内のサイドメニューから「環境」を選択
    - 「マクロファイル用のフォルダ」
1. ここに「dev.mac」を置く
1. 秀丸エディタの「マクロ(M)」→「マクロの登録(E)...」
    - 登録する番号のマクロで「ファイル」コンボボックスを開くと、「dev.mac」が表示されているので選択
    - 名前は好きな名前を
1. 他に登録されていなければ、「マクロ(M)...」メニューの中に表示されるようになっています。
